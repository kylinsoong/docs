= Bind
:toc: manual

== 安装

[source, bash]
.*CentOS 7 上安装 bind*
----
yum install bind bind-utils -y
systemctl enable named && systemctl start named && systemctl status named
----

[source, bash]
.*查看安装的版本*
----
named -v
BIND 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.2 (Extended Support Version) <id:7107deb>
----

== Bind 的配置

[source, bash]
.*地址域名映射表*
----
127.0.0.1 localhost

# These are our main machines
192.249.249.2 shrek.movie.edu shrek
192.249.249.3 toystory.movie.edu toystory toys 
192.249.249.4 monsters-inc.movie.edu monsters-inc mi

# These machines are in horror(ible) shape and will be replaced # soon.
192.253.253.2 misery.movie.edu misery 
192.253.253.3 shining.movie.edu shining 
192.253.253.4 carrie.movie.edu carrie

# A wormhole is a fictitious phenomenon that instantly transports # space travelers over long distances and is not known to be
# stable. The only difference between wormholes and routers is
# that routers don't transport packets as instantly--especially
# ours.
192.249.249.1 wormhole.movie.edu wormhole wh wh249 
192.253.253.1 wormhole.movie.edu wormhole wh wh253
----

[source, bash]
.*db.movie.edu*
----
$TTL 3h
movie.edu. IN SOA toystory.movie.edu. kylin.movie.edu. (
                           1       ; Serial
                           3h      ; Refresh after 3 hours
                           1h      ; Retry after 1 hour
                           1w      ; Expire after 1 week
                           1h )    ; Negative caching TTL of 1 hour
;
; Name servers
;
movie.edu. IN NS toystory.movie.edu.
movie.edu. IN NS wormhole.movie.edu.

;
; Addresses for the canonical names 
;
localhost.movie.edu.        IN A   127.0.0.1
shrek.movie.edu.            IN A   192.249.249.2
toystory.movie.edu.         IN A   192.249.249.3
monsters-inc.movie.edu.     IN A   192.249.249.4
misery.movie.edu.           IN A   192.253.253.2
shining.movie.edu.          IN A   192.253.253.3
carrie.movie.edu.           IN A   192.253.253.4
wormhole.movie.edu.         IN A   192.249.249.1
wormhole.movie.edu.         IN A   192.253.253.1

;
; Aliases
;
toys.movie.edu.        IN CNAME  toystory.movie.edu.
mi.movie.edu.          IN CNAME  monsters-inc.movie.edu.
wh.movie.edu.          IN CNAME  wormhole.movie.edu.

;
; Interface specific names
;
wh249.movie.edu.    IN A 192.249.249.1
wh253.movie.edu.    IN A 192.253.253.1
----

[source, bash]
.*db.192.249.249*
----
$TTL 3h
249.249.192.in-addr.arpa. IN SOA toystory.movie.edu. kylin.movie.edu. (
                           1       ; Serial
                           3h      ; Refresh after 3 hours
                           1h      ; Retry after 1 hour
                           1w      ; Expire after 1 week
                           1h )    ; Negative caching TTL of 1 hour
;
; Name servers
;
249.249.192.in-addr.arpa. IN NS toystory.movie.edu.
249.249.192.in-addr.arpa. IN NS wormhole.movie.edu.

;
; Addresses point to canonical name 
;
1.249.249.192.in-addr.arpa. IN PTR wormhole.movie.edu.
2.249.249.192.in-addr.arpa. IN PTR shrek.movie.edu.
3.249.249.192.in-addr.arpa. IN PTR toystory.movie.edu.
4.249.249.192.in-addr.arpa. IN PTR monsters-inc.movie.edu.
----

[source, bash]
.*db.192.253.253*
----
$TTL 3h
253.253.192.in-addr.arpa. IN SOA toystory.movie.edu. kylin.movie.edu. (
                           1       ; Serial
                           3h      ; Refresh after 3 hours
                           1h      ; Retry after 1 hour
                           1w      ; Expire after 1 week
                           1h )    ; Negative caching TTL of 1 hour
;
; Name servers
;
253.253.192.in-addr.arpa. IN NS toystory.movie.edu.
253.253.192.in-addr.arpa. IN NS wormhole.movie.edu.

;
; Addresses point to canonical name 
;
1.253.253.192.in-addr.arpa. IN PTR wormhole.movie.edu.
2.253.253.192.in-addr.arpa. IN PTR misery.movie.edu.
3.253.253.192.in-addr.arpa. IN PTR shining.movie.edu.
4.253.253.192.in-addr.arpa. IN PTR carrie.movie.edu.
----

[source, bash]
.*编辑 /etc/named.conf，添加*
----
zone "movie.edu" in {
      type master;
      file "db.movie.edu";
};

zone "249.249.192.in-addr.arpa" in {
      type master;
      file "db.192.249.249";
};

zone "253.253.192.in-addr.arpa" in {
      type master;
      file "db.192.253.253";
};

zone "0.0.127.in-addr.arpa" in {
      type master;
      file "db.127.0.0";
};
----

[source, bash]
.*测试*
----
$ nslookup carrie.movie.edu 192.249.249.147
Server:		192.249.249.147
Address:	192.249.249.147#53

Name:	carrie.movie.edu
Address: 192.253.253.4
----

[source, bash]
.**
----

----

[source, bash]
.**
----

----

[source, bash]
.**
----

----
